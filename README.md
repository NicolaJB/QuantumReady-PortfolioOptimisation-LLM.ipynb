
# Portfolio Optimisation with LLM-Derived Risk Scores

This notebook demonstrates **optimisation-based portfolio allocation** where traditional financial expected returns are replaced with **risk scores derived from a language model (LLM)**. The goal is to **minimise portfolio variance (risk)** while maintaining strong expected returns, following **Modern Portfolio Theory (MPT)** principles.

The workflow is suitable for **document-driven risk assessment** and incorporates **structured outputs for auditability and compliance tracking**, demonstrating how AI can support decision-making in regulated environments.

---

## Key Features

- Analyse five major stocks: AAPL, GOOGL, MSFT, AMZN, TSLA  
- Replace financial expected returns with **document-derived risk scores** generated by an LLM  
- Compute portfolio variance and optimise allocations  
- Produce structured outputs for auditability  
- Visualise the optimised portfolio weights  

---

## Step-by-Step Workflow

### 1. Import Libraries
Import Python libraries for data retrieval, numerical computation, optimisation, plotting, and LLM inference.

### 2. Define Tickers and Download Financial Data
Select five major stocks and download historical closing prices from Yahoo Finance.

### 3. Compute Daily Returns and Covariance Matrix
Calculate daily percentage returns and the covariance matrix for portfolio variance computation.

### 4. Generate LLM-Derived Risk Scores
Simulate risk assessment for each stock using an LLM based on hypothetical documents or risk factors. Scores are scaled from 0 (low risk) to 1 (high risk).

### 5. Define Portfolio Variance Function
Calculate total portfolio variance given weights and covariance matrix.

### 6. Define Constraints and Bounds
Ensure portfolio weights sum to 1 and enforce a minimum allocation of 5% per stock.

### 7. Optimise Portfolio Weights
Use scipy.optimize.minimize to find weights minimising variance under constraints.

### 8. Calculate Portfolio Return and Risk
Compute the portfolio’s expected risk score (weighted) and variance. Create an audit log as a structured DataFrame.

### 9. Visualise the Optimised Portfolio
Plot a bar chart showing the allocation across stocks.

### Technologies Used
- Python 3.11
- yfinance – Historical stock data acquisition
- NumPy, Pandas, Matplotlib – Data processing and visualisation
- scipy.optimize – Classical portfolio optimisation
- transformers – LLM inference for risk score generation

### License
This project is licensed under the MIT License.
